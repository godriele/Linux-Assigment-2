#!/bin/bash

# Configuration Setup Scrip!

# ------------------------------------------------------------------------------------------------------------
# Step 1: Git 

if command -v git &> /dev/null; then 
   # this will check whether git is installed and available in the system's path

	git clone https://gitlab.com/cit2420/2420-as2-starting-files ~/config_files
else 
	echo "Your system does not have git installed, Installing git"

	# this will check if pacman is installed 
	if command -v pacman &> /dev/null; then
	
		# if it is, it installs git using pacman 
		sudo pacman -S git
	else
		echo "Error: Please install Git mmanually"
		exit 1
	fi

	git clone https://gitlab.com/cit2420/2420-as2-starting-files ~/config_files
fi 


# ----------------------------------------------------------------------------------------------------------
# Step 2: Listing all the files and directories inside the cloned repository


   config_repo="$HOME/config_files"

   content_files=$(find "$config_repo" -maxdepth 1 -mindepth 1-type d)


# ------------------------------------------------------------------------------------------------------------

# step 3: Connecting symbolic links to our files 


  for content in $content_files; do

      #Here we are getting the abosolute path of the directory
      dir=$(basename "$content_files")

      case "$dir" in
          "bin")
	  	target="$HOME/bin"
		;;
	  "config")
	        target="$HOME/.config"
		;;
   	  "home")
	       target="$HOME/.bashrc"
	        
	       ln -s "$content/bashrc" "$target"
	       continue
	       ;;
      esac
     
      if [ ! -e "$target" ]; then 
         ln -s "$content" "$target"
	 echo "created symlink: $target -> $content"
      else 
         echo "Symlink already exists: $target"
      fi 
done

echo "Configuration was a success"
